window.dtsv={title:document.title};var dtsl={front:{init:function(){dtsl.front.makeTargets();dtsv.images=jQuery("img.dtse-img");dtsl.front.makeDraggable(dtsv.images);dtsv.targets=jQuery("#dtse-targets li");dtsl.front.makeDroppable(dtsv.targets)},createTip:function(a){if(jQuery("#dtse-tip").length===0){jQuery("<div>").html("<span>"+dtsv.tipsLabel+"</span><span class='arrow'></span>").attr("id","dtse-tip").css({left:a.pageX+30,top:a.pageY-16}).appendTo("body").fadeIn(1800)}},makeTargets:function(){var a='<ul id="dtse-targets"><li id="twitter"><a href="http://twitter.com"><!-- --></a></li><li id="delicious"><a href="http://delicious.com"><!-- --></a></li><li id="facebook"><a href="http://www.facebook.com"><!-- --></a></li></ul>';jQuery("body").append(a)},extractClassForPermalink:function(a){var b=/(dtse-post-[0-9]+)/;a=a.match(b);a=a[1].replace(/-/g,"_");return a},makeDraggable:function(id){id.draggable({helper:function(){if(dtsv.sharePermalink===true){var cssClass=jQuery(this).attr("class");cssClass=dtsl.front.extractClassForPermalink(cssClass);dtsv.currentUrl=eval("dtsv."+cssClass+"_permalink");dtsv.title=eval("dtsv."+cssClass+"_title")}return jQuery("<div>").attr("id","dtse-helper").html("<span>"+dtsv.title+"</span><img id='dtse-thumb' src='"+jQuery(this).attr("src")+"'>").appendTo("body")},cursor:"pointer",cursorAt:{left:180,top:53},zIndex:99999,start:function(){jQuery("<div>").attr("id","dtse-overlay").css("opacity",0.7).appendTo("body");jQuery("#dtse-tip").remove();jQuery(this).unbind("mouseenter");dtsv.targetsID=jQuery("#dtse-targets");dtsv.targetsID.css("left",(jQuery("body").width()/2)-dtsv.targetsID.width()/2);var targetHeight=dtsv.targetsID.height();if(dtsv.targetsPosition=="middle"){var middle=(jQuery(window).height()/2-targetHeight/2);dtsv.targetsID.css("top",middle+"px").slideDown()}if(dtsv.targetsPosition=="bottom"){var bottom=(jQuery(window).height()-(targetHeight*2)-10);dtsv.targetsID.css("top",bottom+"px").slideDown()}if((dtsv.targetsPosition=="top")||(dtsv.targetsPosition===undefined)){dtsv.targetsID.slideDown()}},stop:function(){dtsv.targetsID.slideUp();jQuery("span.dtse-share",dtsv.targetsID).remove();jQuery("#dtse-overlay").remove();jQuery(this).bind("mouseenter",dtsl.front.createTip)}}).bind("mouseenter",dtsl.front.createTip).mousemove(function(e){jQuery("#dtse-tip").css({left:e.pageX+30,top:e.pageY-16})}).mouseleave(function(){jQuery("#dtse-tip").remove()})},makeDroppable:function(a){a.droppable({tolerance:"pointer",over:function(){jQuery("span.dtse-share","#dtse-targets").remove();jQuery("<span>").addClass("dtse-share").text(dtsv.targetsLabel+" "+jQuery(this).attr("id")).addClass("active").appendTo(jQuery(this)).fadeIn()},drop:function(){var c=jQuery(this).attr("id");var b=dtsv.currentUrl;if(dtsv.sharePermalink===false){b=window.location.href}baseUrl=jQuery(this).find("a").attr("href");if(c.indexOf("twitter")!=-1){dtsl.front.shareOnTwitter(baseUrl,b)}else{if(c.indexOf("delicious")!=-1){window.location.href=baseUrl+"/save?url="+b+"&title="+dtsv.title}else{if(c.indexOf("facebook")!=-1){window.location.href=baseUrl+"/sharer.php?u="+b+"&t="+dtsv.title}}}}})},shareOnTwitter:function(a,b){jQuery.ajax({type:"GET",url:dtsv.root+"lib/dtse.ajax.php",data:"longurl="+b,dataType:"text",success:function(c){window.location.href=a+"/home?status="+dtsv.title+": "+c},error:function(c,e,d){window.location.href=a+"/home?status="+dtsv.title+": "+b}})}}};